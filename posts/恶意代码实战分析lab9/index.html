<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>恶意代码分析实战Lab9 - xia0le&#39;s Blog</title><meta name="author" content="xia0le">
<meta name="description" content="恶意代码分析实战Lab9
"><meta name="keywords" content='病毒分析, Binary'>
  <meta itemprop="name" content="恶意代码分析实战Lab9">
  <meta itemprop="description" content="恶意代码分析实战Lab9">
  <meta itemprop="datePublished" content="2022-03-29T21:47:44+08:00">
  <meta itemprop="dateModified" content="2022-03-29T21:47:44+08:00">
  <meta itemprop="wordCount" content="198">
  <meta itemprop="keywords" content="病毒分析,Binary"><meta property="og:url" content="http://localhost:1313/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/">
  <meta property="og:site_name" content="xia0le&#39;s Blog">
  <meta property="og:title" content="恶意代码分析实战Lab9">
  <meta property="og:description" content="恶意代码分析实战Lab9">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-03-29T21:47:44+08:00">
    <meta property="article:modified_time" content="2022-03-29T21:47:44+08:00">
    <meta property="article:tag" content="病毒分析">
    <meta property="article:tag" content="Binary">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="恶意代码分析实战Lab9">
  <meta name="twitter:description" content="恶意代码分析实战Lab9">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/" title="恶意代码分析实战Lab9 - xia0le&#39;s Blog" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab1/" title="恶意代码分析实战Lab1" /><link rel="next" type="text/html" href="http://localhost:1313/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab7/" title="恶意代码分析实战Lab7" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "恶意代码分析实战Lab9",
    "inLanguage": "en-us",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9\/"
    },"genre": "posts","keywords": "病毒分析, Binary","wordcount":  198 ,
    "url": "http:\/\/localhost:1313\/posts\/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9\/","datePublished": "2022-03-29T21:47:44+08:00","dateModified": "2022-03-29T21:47:44+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "xia0le"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="xia0le&#39;s Blog"><span class="header-title-text">xia0le&#39;s Blog</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Archives</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a class="menu-link" href="/about/"><i class="fa-solid fa-user fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="xia0le&#39;s Blog"><span class="header-title-text">xia0le&#39;s Blog</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="menu-item"><a class="menu-link" href="/posts/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Archives</a></li><li class="menu-item"><a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item"><a class="menu-link" href="/about/"><i class="fa-solid fa-user fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span title="Repost" class="icon-repost"><i class="fa-solid fa-share fa-fw" aria-hidden="true"></i></span><span>恶意代码分析实战Lab9</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      xia0le</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98/" class="post-category" title="Category - 恶意代码分析实战"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 恶意代码分析实战</a></span></div><div class="post-meta-line"><span title="published on 2022-03-29 21:47:44"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2022-03-29">2022-03-29</time></span>&nbsp;<span title="198 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 200 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>One minute</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1如何让这个恶意代码安装自身">1．如何让这个恶意代码安装自身?</a></li>
    <li><a href="#2这个恶意代码的命令行选项是什么它要求的密码是什么">2.这个恶意代码的命令行选项是什么?它要求的密码是什么?</a></li>
    <li><a href="#3如何利用ollydbg永久修补这个恶意代码使其不需要指定的命令行密码">3．如何利用OllyDbg永久修补这个恶意代码，使其不需要指定的命令行密码?</a></li>
    <li><a href="#4这个恶意代码基于系统的特征是什么">4．这个恶意代码基于系统的特征是什么?</a></li>
    <li><a href="#5这个恶意代码通过网络命令执行了哪些不同操作">5．这个恶意代码通过网络命令执行了哪些不同操作?</a></li>
    <li><a href="#6这个恶意代码是否有网络特征">6．这个恶意代码是否有网络特征?</a></li>
  </ul>

  <ul>
    <li><a href="#1在二进制文件中你看到的静态字符串是什么">1．在二进制文件中，你看到的静态字符串是什么?</a></li>
    <li><a href="#2当你运行这个二进制文件时会发生什么">2．当你运行这个二进制文件时，会发生什么?</a></li>
    <li><a href="#3怎样让恶意代码的攻击负载payload获得运行">3．怎样让恶意代码的攻击负载（payload）获得运行?</a></li>
    <li><a href="#4在地址ox00401133处发生了什么">4．在地址Ox00401133处发生了什么?</a></li>
    <li><a href="#5传递给子例程函数ox00401089的参数是什么">5．传递给子例程（函数）Ox00401089的参数是什么?</a></li>
    <li><a href="#6恶意代码使用的域名是什么">6．恶意代码使用的域名是什么?</a></li>
    <li><a href="#7恶意代码使用什么编码函数来混淆域名">7．恶意代码使用什么编码函数来混淆域名?</a></li>
    <li><a href="#8恶意代码在0x0040106e处调用createprocessa函数的意义是什么">8．恶意代码在0x0040106E处调用createProcessA函数的意义是什么?</a></li>
  </ul>

  <ul>
    <li><a href="#1lab09-03exe导入了哪些dll">1.Lab09-03.exe导入了哪些DLL?</a></li>
    <li><a href="#2dll1dlldll2dlldll3dll要求的基地址是多少">2.DLL1.dll、DLL2.dll、DLL3.dll要求的基地址是多少?</a></li>
    <li><a href="#3当使用ollydbg调试lab09-03exe时为dllldlldll2dlldll3dll分配的基地址是什么">3.当使用OllyDbg调试Lab09-03.exe时，为DLLl.dll、DLL2.dll、DLL3.dll分配的基地址是什么?</a></li>
    <li><a href="#4当lab09-03exe调用dllidll中的一个导入函数时这个导入函数都做了些什么">4.当Lab09-03.exe调用DLLI.dll中的一个导入函数时，这个导入函数都做了些什么?</a></li>
    <li><a href="#5当lab09-03exe调用writefile函数时它写入的文件名是什么">5.当Lab09-03.exe调用writeFile函数时，它写入的文件名是什么?</a></li>
    <li><a href="#6当lab09-03exe使用netschedulejobadd创建一个job时从哪里获取第二个参数的数据">6.当Lab09-03.exe使用NetScheduleJobAdd创建一个job时，从哪里获取第二个参数的数据?</a>
      <ul>
        <li><a href="#分析dll3dll">分析DLL3.dll</a></li>
      </ul>
    </li>
    <li><a href="#7在运行或调试lab09-03exe时你会看到lab09-03exe打印出三块神秘数据dll-1的神秘数据dll2的神秘数据dll-3的神秘数据分别是什么">7.在运行或调试Lab09-03.exe时,你会看到Lab09-03.exe打印出三块神秘数据。DLL 1的神秘数据，DLL2的神秘数据，DLL 3的神秘数据分别是什么?</a>
      <ul>
        <li><a href="#dll1神秘数据">DLL1神秘数据</a></li>
        <li><a href="#dll2神秘数据">DLL2神秘数据</a></li>
        <li><a href="#dll3神秘数据">DLL3神秘数据</a></li>
      </ul>
    </li>
    <li><a href="#8如何将dll2dll加载到ida-pro中使得它与ollydbg-使用的加载地址匹配">8.如何将DLL2.dll加载到IDA Pro中，使得它与OllyDbg 使用的加载地址匹配?</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><p>恶意代码分析实战Lab9</p>
<h2 id="lab9-1" class="heading-element"><span>Lab9-1</span>
  <a href="#lab9-1" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>这个程序就是第三章lab03-04那个会删除自身的程序,之前我们没有分析完,现在继续</p>
<p>IDApro打开程序,程序要求参数要大于1,这就说明我们需要输入lab09-01.exe &ldquo;一些参数&quot;这样的方式才能启动程序,为什么呢,因为如果不跳转,那么下面不管是在jz处是否跳转结果都会跳转到下面这个地方直接结束程序.(未安装时候才是这种情况)</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410092731-jh0q4pu.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410092731-jh0q4pu.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410092731-jh0q4pu.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410092731-jh0q4pu.png?size=large 2x" data-title="image.png" style="--width: 1131px;--aspect-ratio: 1131 / 505;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>区别就是sub401000在找一个注册表项(实际上我在xp和win7下跟踪发现他永远都是找不到的,也就是返回值永远是0,那么他就会跳转到402B13,再执行402410删除自身)</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519145721493-20220410093117-ry6ysnw.png" alt="20180519145721493.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519145721493-20220410093117-ry6ysnw.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519145721493-20220410093117-ry6ysnw.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519145721493-20220410093117-ry6ysnw.png?size=large 2x" data-title="20180519145721493.png" style="--width: 819px;--aspect-ratio: 819 / 123;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>还记得第三章的分析的话有下面截图,下面的几个参数/c del &raquo;null cmd.exe你们都会在402410函数里面找到,也就是说402410将会删除程序自身.</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519143423190-20220410093130-xmxanqe.png" alt="20180519143423190.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519143423190-20220410093130-xmxanqe.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519143423190-20220410093130-xmxanqe.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519143423190-20220410093130-xmxanqe.png?size=large 2x" data-title="20180519143423190.png" style="--width: 907px;--aspect-ratio: 907 / 112;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>我们要找找到底需要什么参数才能让程序运行,最后一个参数(我们的目标就是知道这个参数是啥)被传给sub_402510函数作为参数,看来需要跟踪进这个函数才能解开秘密</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519145859340-20220410093310-dosyxo4.png" alt="20180519145859340.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519145859340-20220410093310-dosyxo4.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519145859340-20220410093310-dosyxo4.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519145859340-20220410093310-dosyxo4.png?size=large 2x" data-title="20180519145859340.png" style="--width: 346px;--aspect-ratio: 346 / 130;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>开头这一段是在看参数的字节数是不是4,这个自己体会一下,或者再ollydbg里面跟踪运行一下就知道他在干嘛,经验丰富的话一般会比较快的意识到他在做什么,没经验也不能理解这段代码,好了现在我们知道参数是四个字符</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519150131454-20220410093545-4k7bgrt.png" alt="20180519150131454.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519150131454-20220410093545-4k7bgrt.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519150131454-20220410093545-4k7bgrt.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519150131454-20220410093545-4k7bgrt.png?size=large 2x" data-title="20180519150131454.png" style="--width: 262px;--aspect-ratio: 262 / 204;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>接着往下走,看关键cmp再联系上下文知道比较的双方是什么,你就会很快明白在做什么(这里的a原本是'61h&rsquo;,被我标记为a了这样比较明了),很明显edx是参数的第一个字节,他在和a比较,那就是说第一个字符是a</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410093657-afoktq1.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410093657-afoktq1.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410093657-afoktq1.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410093657-afoktq1.png?size=large 2x" data-title="image.png" style="--width: 433px;--aspect-ratio: 433 / 237;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>接着cmp是ecx和1比较,那么ecx是啥?联系上文你会发现,ecx是参数的第二个字符减去参数的第一个字符的值,也就是说第二个字符是b</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094012-9vgwzdd.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094012-9vgwzdd.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094012-9vgwzdd.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094012-9vgwzdd.png?size=large 2x" data-title="image.png" style="--width: 240px;--aspect-ratio: 240 / 228;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>做了一系列事还有乘法,其实你会发现她其实就是再看第三个字符c</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094137-540mnaf.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094137-540mnaf.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094137-540mnaf.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094137-540mnaf.png?size=large 2x" data-title="image.png" style="--width: 308px;--aspect-ratio: 308 / 248;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>最后一个字符,很可能就是d了</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094255-q87wdzz.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094255-q87wdzz.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094255-q87wdzz.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094255-q87wdzz.png?size=large 2x" data-title="image.png" style="--width: 349px;--aspect-ratio: 349 / 200;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>onlydbg打开</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094751-3dbkhig.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094751-3dbkhig.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094751-3dbkhig.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410094751-3dbkhig.png?size=large 2x" data-title="image.png" style="--width: 438px;--aspect-ratio: 438 / 276;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>在sub_402510函数调用后f2断点，返回值为1</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410095933-dtix6fr.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410095933-dtix6fr.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410095933-dtix6fr.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410095933-dtix6fr.png?size=large 2x" data-title="image.png" style="--width: 1442px;--aspect-ratio: 1442 / 870;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>还没完,接下来下面代码是一样的不过一个是再ollydbg一个是IDApro打开的,你会发现他需要第三个参数-in(安装可能推测),那么没有呢他会怎么办?一路跟踪发现他会考虑是否有参数-in -re -c -cc这是个参数,如果都没有还是会删除自身(这波结论可以很容易得出,自己用ollydbg&rsquo;或者idapro跟踪一下即明白)</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519152637813-20220410100411-eqncvl2.png" alt="20180519152637813.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519152637813-20220410100411-eqncvl2.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519152637813-20220410100411-eqncvl2.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519152637813-20220410100411-eqncvl2.png?size=large 2x" data-title="20180519152637813.png" style="--width: 371px;--aspect-ratio: 371 / 115;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519152648511-20220410100415-ye0jv34.png" alt="20180519152648511.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519152648511-20220410100415-ye0jv34.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519152648511-20220410100415-ye0jv34.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519152648511-20220410100415-ye0jv34.png?size=large 2x" data-title="20180519152648511.png" style="--width: 541px;--aspect-ratio: 541 / 141;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><br>
那么有参数-in他会做什么?(很可能安装程序猜测)关键函数他的参数被标记为一个服务名,看看这个函数做什么,他实际上就调用两个函数,再结合实际代码会知道,他是要得到完整路径(getmodulefilename),然后得到文件名Lab09-01.exe(splitpatch)作为服务名返回.</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410100208-6m2uv7v.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410100208-6m2uv7v.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410100208-6m2uv7v.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410100208-6m2uv7v.png?size=large 2x" data-title="image.png" style="--width: 847px;--aspect-ratio: 847 / 292;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>好了,现在得到服务名了,接着做什么?(猜测可能是安装程序为一个服务),看来关键代码再函数402600了</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519153621699-20220410100609-uol488y.png" alt="20180519153621699.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519153621699-20220410100609-uol488y.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519153621699-20220410100609-uol488y.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519153621699-20220410100609-uol488y.png?size=large 2x" data-title="20180519153621699.png" style="--width: 517px;--aspect-ratio: 517 / 103;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>前面一串先不管,没必要陷入细节,我们看到他打开服务控制管理器,然后打开一个服务(服务名就是程序名Lab09-01),成功也就是服务存在那就把他设置成自启动,否则就创建这个服务,并设置为自启动,然后结束,这一波结论的得出其实不难几个关键的函数已经说明问题(如果你熟悉这些函数的话)</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519154418730-20220410100750-d0ntd7g.png" alt="20180519154418730.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519154418730-20220410100750-d0ntd7g.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519154418730-20220410100750-d0ntd7g.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519154418730-20220410100750-d0ntd7g.png?size=large 2x" data-title="20180519154418730.png" style="--width: 337px;--aspect-ratio: 337 / 66;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>注意这里的关键参数dwstarttype</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/2018051915450197-20220410100758-6af3lkj.png" alt="2018051915450197.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/2018051915450197-20220410100758-6af3lkj.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/2018051915450197-20220410100758-6af3lkj.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/2018051915450197-20220410100758-6af3lkj.png?size=large 2x" data-title="2018051915450197.png" style="--width: 366px;--aspect-ratio: 366 / 222;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>从创建服务的参数我们可以知道,恶意程序被复制到system32目录下了.</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519160516651-20220410100858-d04a2cl.png" alt="20180519160516651.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519160516651-20220410100858-d04a2cl.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519160516651-20220410100858-d04a2cl.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519160516651-20220410100858-d04a2cl.png?size=large 2x" data-title="20180519160516651.png" style="--width: 578px;--aspect-ratio: 578 / 267;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162337120-20220410100855-87zgxqz.png" alt="20180519162337120.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162337120-20220410100855-87zgxqz.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162337120-20220410100855-87zgxqz.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162337120-20220410100855-87zgxqz.png?size=large 2x" data-title="20180519162337120.png" style="--width: 986px;--aspect-ratio: 986 / 129;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>还没完,在服务成功注册或者被设置为自启动后,他还会创建一个注册表项(SOFTWARE\Microsoft \XPS)在函数sub_401070里面</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162450890-20220410100911-trm6ek4.png" alt="20180519162450890.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162450890-20220410100911-trm6ek4.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162450890-20220410100911-trm6ek4.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162450890-20220410100911-trm6ek4.png?size=large 2x" data-title="20180519162450890.png" style="--width: 658px;--aspect-ratio: 658 / 226;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>并且设置Configuration键值为图中数据区字符串.</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162600800-20220410100946-44rz9fl.png" alt="20180519162600800.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162600800-20220410100946-44rz9fl.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162600800-20220410100946-44rz9fl.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162600800-20220410100946-44rz9fl.png?size=large 2x" data-title="20180519162600800.png" style="--width: 1271px;--aspect-ratio: 1271 / 374;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>补充:这里有个发现比较如果参数个数不是3的话,我们可以指定第四个参数作为服务名字</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101623-142umoa.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101623-142umoa.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101623-142umoa.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101623-142umoa.png?size=large 2x" data-title="image.png" style="--width: 712px;--aspect-ratio: 712 / 195;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>现在看看命令-re做什么,我们可以看到程序的结构和-in很像,他也可以指定第四个参数作为要删除的服务名称,代码的关键函数调用deleteservice告诉我们他是删除程序自身.</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101707-tvwcglw.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101707-tvwcglw.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101707-tvwcglw.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101707-tvwcglw.png?size=large 2x" data-title="image.png" style="--width: 760px;--aspect-ratio: 760 / 138;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>看-c命令,发现他一共需要七个参数,然后调用401070这个函数,这个函数我们之前分析过看看之前对这个函数的调用,我们不难知道-c是对键值configuration的修改操作.</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101738-pfbj5vu.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101738-pfbj5vu.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101738-pfbj5vu.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101738-pfbj5vu.png?size=large 2x" data-title="image.png" style="--width: 873px;--aspect-ratio: 873 / 201;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>再看看最后的-cc命令,看到这种格式我们很容易联想到输出,实际操作也证明这一点,-cc就是打印configuration这个键值</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171632626-20220410101535-map3pid.png" alt="20180519171632626.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171632626-20220410101535-map3pid.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171632626-20220410101535-map3pid.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171632626-20220410101535-map3pid.png?size=large 2x" data-title="20180519171632626.png" style="--width: 452px;--aspect-ratio: 452 / 426;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171529562-20220410101756-rze5t6p.png" alt="20180519171529562.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171529562-20220410101756-rze5t6p.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171529562-20220410101756-rze5t6p.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171529562-20220410101756-rze5t6p.png?size=large 2x" data-title="20180519171529562.png" style="--width: 653px;--aspect-ratio: 653 / 72;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>还没完,如果程序已经安装以服务方式运行,没有那些参数,那么他会运行sub_402360函数,然后依据函数sub_401E60返回的值做相应的操作:SLEEP UPLOAD DOWNLOAD CMD NOTHING这五种操作,所以先看看401E60函数,我们猜测这可能是接受远端发来命令的函数,那么一定有网络相关操作,在函数sub_401AF0里面有一系列网络函数操作,其中调用401640是一系列网络初始操作,再往下会发现send和recv操作,至于上面五种操作具体做什么就不一一具体分析,因为从名字上就可以知道分别是,睡眠,下载文件到本地,读取文件到远端主机,用cmd.exe运行shell命令,和什么都不做</p>
<p>分析一下各个命令参数形式sleep的参数得自strtok第二次分割得到的值也就是说格式为SLEEP time</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519175625580-20220410101941-45qtpox.png" alt="20180519175625580.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519175625580-20220410101941-45qtpox.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519175625580-20220410101941-45qtpox.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519175625580-20220410101941-45qtpox.png?size=large 2x" data-title="20180519175625580.png" style="--width: 344px;--aspect-ratio: 344 / 196;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>看UPLOAD的关键函数调用有三个参数,name是主机名(ollydbg可以看到就是http://www.practicalmalwareanalysis.com),文件名和端口是命令指定,格式UPLOAD port filename</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519175814103-20220410101949-99yk224.png" alt="20180519175814103.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519175814103-20220410101949-99yk224.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519175814103-20220410101949-99yk224.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519175814103-20220410101949-99yk224.png?size=large 2x" data-title="20180519175814103.png" style="--width: 316px;--aspect-ratio: 316 / 101;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>DOWNLOAD和UPLOAD很类似就不说了看看CMD,下图是在创建并运行子进程 等同于cmd.exe /c command形式运行cmd,其中arg_0是_popen的参数,所以</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519182015859-20220410101959-xygzeqy.png" alt="20180519182015859.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519182015859-20220410101959-xygzeqy.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519182015859-20220410101959-xygzeqy.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519182015859-20220410101959-xygzeqy.png?size=large 2x" data-title="20180519182015859.png" style="--width: 268px;--aspect-ratio: 268 / 163;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>还没完,CMD还需要在函数401790里面读取标准输出内容然后从指定端口发送给远端主机</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519182620275-20220410102010-34yhx1g.png" alt="20180519182620275.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519182620275-20220410102010-34yhx1g.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519182620275-20220410102010-34yhx1g.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519182620275-20220410102010-34yhx1g.png?size=large 2x" data-title="20180519182620275.png" style="--width: 272px;--aspect-ratio: 272 / 291;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>在loc_401B35显示恶意程序最初是构造HTTP/1.0 GET请求,则可以作为网络特征</p>
<p>代码分析到现在,其实已经差不多了,对于恶意代码我们已经基本掌握他的目的功能,实际上我们忽略了一些具体的细节比如对接收到的数据包的具体解析以得到具体命令我们就没有分析,还有一些内存操作也没有具体分析,但是我们发现这并不影响我们了解并掌握这个恶意代码的具体流程,所以这就是为什么我们常说不能迷失在代码中不能过分关注细节,我们的目的很明确就是了解恶意代码的目的和功能,我们要以最有效的手段来达到目的,当代码量很大的时候这点尤为重要,然后就是ollydbg和IDApro的使用,实际上在分析上述代码的时候我少使用ollydbg,基本使用IDApro来完成分析,但是我发现ollydbg必不可少,比如在分析参数name的时候我在IDApro里面找了半天也没有找到证据说这个name就是http://www.practicalmalwareanalysis.com尽管我坚信他就是这个,但是没有证据,然而我用ollydbg却可以轻松的看到name就是这个网址,所以在分析恶意代码时候两者缺一不可,IDApro很强大但是,他毕竟主要是静态分析,有时候很难的静态分析,我们只需要ollydbg就可以很轻松的完成分析,所以如何取舍才能更快的完成分析也很重要.</p>
<h2 id="1如何让这个恶意代码安装自身" class="heading-element"><span>1．如何让这个恶意代码安装自身?</span>
  <a href="#1%e5%a6%82%e4%bd%95%e8%ae%a9%e8%bf%99%e4%b8%aa%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81%e5%ae%89%e8%a3%85%e8%87%aa%e8%ba%ab" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171529562-20220410101756-rze5t6p.png" alt="20180519171529562.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171529562-20220410101756-rze5t6p.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171529562-20220410101756-rze5t6p.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519171529562-20220410101756-rze5t6p.png?size=large 2x" data-title="20180519171529562.png" style="--width: 653px;--aspect-ratio: 653 / 72;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="2这个恶意代码的命令行选项是什么它要求的密码是什么" class="heading-element"><span>2.这个恶意代码的命令行选项是什么?它要求的密码是什么?</span>
  <a href="#2%e8%bf%99%e4%b8%aa%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81%e7%9a%84%e5%91%bd%e4%bb%a4%e8%a1%8c%e9%80%89%e9%a1%b9%e6%98%af%e4%bb%80%e4%b9%88%e5%ae%83%e8%a6%81%e6%b1%82%e7%9a%84%e5%af%86%e7%a0%81%e6%98%af%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>lab09-01.exe -cc abcd</p>
<h2 id="3如何利用ollydbg永久修补这个恶意代码使其不需要指定的命令行密码" class="heading-element"><span>3．如何利用OllyDbg永久修补这个恶意代码，使其不需要指定的命令行密码?</span>
  <a href="#3%e5%a6%82%e4%bd%95%e5%88%a9%e7%94%a8ollydbg%e6%b0%b8%e4%b9%85%e4%bf%ae%e8%a1%a5%e8%bf%99%e4%b8%aa%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81%e4%bd%bf%e5%85%b6%e4%b8%8d%e9%9c%80%e8%a6%81%e6%8c%87%e5%ae%9a%e7%9a%84%e5%91%bd%e4%bb%a4%e8%a1%8c%e5%af%86%e7%a0%81" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>将sub_402510函数返回修改为1然后patch</p>
<h2 id="4这个恶意代码基于系统的特征是什么" class="heading-element"><span>4．这个恶意代码基于系统的特征是什么?</span>
  <a href="#4%e8%bf%99%e4%b8%aa%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81%e5%9f%ba%e4%ba%8e%e7%b3%bb%e7%bb%9f%e7%9a%84%e7%89%b9%e5%be%81%e6%98%af%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>从创建服务的参数我们可以知道,恶意程序被复制到system32目录下了.</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519160516651-20220410100858-d04a2cl.png" alt="20180519160516651.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519160516651-20220410100858-d04a2cl.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519160516651-20220410100858-d04a2cl.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519160516651-20220410100858-d04a2cl.png?size=large 2x" data-title="20180519160516651.png" style="--width: 578px;--aspect-ratio: 578 / 267;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162337120-20220410100855-87zgxqz.png" alt="20180519162337120.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162337120-20220410100855-87zgxqz.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162337120-20220410100855-87zgxqz.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180519162337120-20220410100855-87zgxqz.png?size=large 2x" data-title="20180519162337120.png" style="--width: 986px;--aspect-ratio: 986 / 129;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="5这个恶意代码通过网络命令执行了哪些不同操作" class="heading-element"><span>5．这个恶意代码通过网络命令执行了哪些不同操作?</span>
  <a href="#5%e8%bf%99%e4%b8%aa%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81%e9%80%9a%e8%bf%87%e7%bd%91%e7%bb%9c%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c%e4%ba%86%e5%93%aa%e4%ba%9b%e4%b8%8d%e5%90%8c%e6%93%8d%e4%bd%9c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>‍</p>
<h2 id="6这个恶意代码是否有网络特征" class="heading-element"><span>6．这个恶意代码是否有网络特征?</span>
  <a href="#6%e8%bf%99%e4%b8%aa%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81%e6%98%af%e5%90%a6%e6%9c%89%e7%bd%91%e7%bb%9c%e7%89%b9%e5%be%81" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101738-pfbj5vu.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101738-pfbj5vu.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101738-pfbj5vu.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410101738-pfbj5vu.png?size=large 2x" data-title="image.png" style="--width: 873px;--aspect-ratio: 873 / 201;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>‍</p>
<h2 id="lab9-2" class="heading-element"><span>Lab9-2</span>
  <a href="#lab9-2" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h2 id="1在二进制文件中你看到的静态字符串是什么" class="heading-element"><span>1．在二进制文件中，你看到的静态字符串是什么?</span>
  <a href="#1%e5%9c%a8%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%96%87%e4%bb%b6%e4%b8%ad%e4%bd%a0%e7%9c%8b%e5%88%b0%e7%9a%84%e9%9d%99%e6%80%81%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%98%af%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410102915-zqcp5d7.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410102915-zqcp5d7.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410102915-zqcp5d7.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410102915-zqcp5d7.png?size=large 2x" data-title="image.png" style="--width: 1087px;--aspect-ratio: 1087 / 831;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="2当你运行这个二进制文件时会发生什么" class="heading-element"><span>2．当你运行这个二进制文件时，会发生什么?</span>
  <a href="#2%e5%bd%93%e4%bd%a0%e8%bf%90%e8%a1%8c%e8%bf%99%e4%b8%aa%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%96%87%e4%bb%b6%e6%97%b6%e4%bc%9a%e5%8f%91%e7%94%9f%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>无</p>
<h2 id="3怎样让恶意代码的攻击负载payload获得运行" class="heading-element"><span>3．怎样让恶意代码的攻击负载（payload）获得运行?</span>
  <a href="#3%e6%80%8e%e6%a0%b7%e8%ae%a9%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81%e7%9a%84%e6%94%bb%e5%87%bb%e8%b4%9f%e8%bd%bdpayload%e8%8e%b7%e5%be%97%e8%bf%90%e8%a1%8c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>ida 查看main函数地址401128</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103449-4cg1ijo.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103449-4cg1ijo.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103449-4cg1ijo.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103449-4cg1ijo.png?size=large 2x" data-title="image.png" style="--width: 648px;--aspect-ratio: 648 / 362;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>onlydgb ctrl+g跳到main ，f2下断点，f9运行</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103433-e8t4hij.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103433-e8t4hij.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103433-e8t4hij.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103433-e8t4hij.png?size=large 2x" data-title="image.png" style="--width: 1157px;--aspect-ratio: 1157 / 719;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>两段字符串</p>
<p>ida按r转字符查看</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103834-7vfqplk.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103834-7vfqplk.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103834-7vfqplk.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410103834-7vfqplk.png?size=large 2x" data-title="image.png" style="--width: 532px;--aspect-ratio: 532 / 371;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>getmodulefilename获取当前程序的路径</p>
<p>数据窗口跟随，后f8查看路径</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410104522-3317i56.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410104522-3317i56.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410104522-3317i56.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410104522-3317i56.png?size=large 2x" data-title="image.png" style="--width: 1258px;--aspect-ratio: 1258 / 775;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>call 401550调用的2个参数在栈空间</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410104738-9fujftd.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410104738-9fujftd.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410104738-9fujftd.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410104738-9fujftd.png?size=large 2x" data-title="image.png" style="--width: 1683px;--aspect-ratio: 1683 / 719;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>ida可用查看到调用的是_strrchr函数（用来查找路径中最后一次出现\的位置，并且返回\位置后的字符，获取应用名称）</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105011-5qrzpmh.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105011-5qrzpmh.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105011-5qrzpmh.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105011-5qrzpmh.png?size=large 2x" data-title="image.png" style="--width: 581px;--aspect-ratio: 581 / 286;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>函数返回为程序名称</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105218-sbzg3g2.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105218-sbzg3g2.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105218-sbzg3g2.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105218-sbzg3g2.png?size=large 2x" data-title="image.png" style="--width: 1491px;--aspect-ratio: 1491 / 596;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>call 4014c0函数2个参数</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105420-nkpx0yf.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105420-nkpx0yf.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105420-nkpx0yf.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105420-nkpx0yf.png?size=large 2x" data-title="image.png" style="--width: 1675px;--aspect-ratio: 1675 / 848;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>ida查看这个是_strcmp</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105548-3741frq.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105548-3741frq.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105548-3741frq.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105548-3741frq.png?size=large 2x" data-title="image.png" style="--width: 437px;--aspect-ratio: 437 / 83;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>字符串不相等则非0</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105617-mry083a.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105617-mry083a.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105617-mry083a.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105617-mry083a.png?size=large 2x" data-title="image.png" style="--width: 1438px;--aspect-ratio: 1438 / 574;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>ida分析 je 40124c</p>
<p>不相等则走红色线（退出main）</p>
<p>相等则走绿色</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105805-mvj07f3.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105805-mvj07f3.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105805-mvj07f3.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105805-mvj07f3.png?size=large 2x" data-title="image.png" style="--width: 1089px;--aspect-ratio: 1089 / 464;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>退出main，这是程序退出的原因</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105855-rfi0q85.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105855-rfi0q85.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105855-rfi0q85.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410105855-rfi0q85.png?size=large 2x" data-title="image.png" style="--width: 807px;--aspect-ratio: 807 / 641;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>要使程序运行将程序名称改为ocl.exe即可</p>
<p>od打开断点运行，判断返回0</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110220-4dsov7g.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110220-4dsov7g.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110220-4dsov7g.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110220-4dsov7g.png?size=large 2x" data-title="image.png" style="--width: 1490px;--aspect-ratio: 1490 / 692;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>程序名改为ocl.exe即可运行</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110341-4yl1pao.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110341-4yl1pao.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110341-4yl1pao.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110341-4yl1pao.png?size=large 2x" data-title="image.png" style="--width: 1251px;--aspect-ratio: 1251 / 549;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="4在地址ox00401133处发生了什么" class="heading-element"><span>4．在地址Ox00401133处发生了什么?</span>
  <a href="#4%e5%9c%a8%e5%9c%b0%e5%9d%80ox00401133%e5%a4%84%e5%8f%91%e7%94%9f%e4%ba%86%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>将值赋值到栈空间</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110457-rbp9cdx.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110457-rbp9cdx.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110457-rbp9cdx.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110457-rbp9cdx.png?size=large 2x" data-title="image.png" style="--width: 420px;--aspect-ratio: 420 / 392;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>‍</p>
<h2 id="5传递给子例程函数ox00401089的参数是什么" class="heading-element"><span>5．传递给子例程（函数）Ox00401089的参数是什么?</span>
  <a href="#5%e4%bc%a0%e9%80%92%e7%bb%99%e5%ad%90%e4%be%8b%e7%a8%8b%e5%87%bd%e6%95%b0ox00401089%e7%9a%84%e5%8f%82%e6%95%b0%e6%98%af%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>onlydbg跳转到这个函数下断点</p>
<p>参数1为1qaz2wsx3edc</p>
<p>参数2暂时无法识别</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110742-mt5kz4x.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110742-mt5kz4x.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110742-mt5kz4x.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110742-mt5kz4x.png?size=large 2x" data-title="image.png" style="--width: 1403px;--aspect-ratio: 1403 / 690;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="6恶意代码使用的域名是什么" class="heading-element"><span>6．恶意代码使用的域名是什么?</span>
  <a href="#6%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81%e4%bd%bf%e7%94%a8%e7%9a%84%e5%9f%9f%e5%90%8d%e6%98%af%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>循环</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111040-oo0a5ei.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111040-oo0a5ei.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111040-oo0a5ei.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111040-oo0a5ei.png?size=large 2x" data-title="image.png" style="--width: 1482px;--aspect-ratio: 1482 / 857;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>f5可以看到两个参数亦或，应该是解密</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111652-yvcsiwc.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111652-yvcsiwc.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111652-yvcsiwc.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111652-yvcsiwc.png?size=large 2x" data-title="image.png" style="--width: 511px;--aspect-ratio: 511 / 323;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>动调查看解密后结果，www.practicalmalwareanalysis.com</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111849-2lxauxe.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111849-2lxauxe.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111849-2lxauxe.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111849-2lxauxe.png?size=large 2x" data-title="image.png" style="--width: 1672px;--aspect-ratio: 1672 / 781;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="7恶意代码使用什么编码函数来混淆域名" class="heading-element"><span>7．恶意代码使用什么编码函数来混淆域名?</span>
  <a href="#7%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81%e4%bd%bf%e7%94%a8%e4%bb%80%e4%b9%88%e7%bc%96%e7%a0%81%e5%87%bd%e6%95%b0%e6%9d%a5%e6%b7%b7%e6%b7%86%e5%9f%9f%e5%90%8d" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>gethostname的参数正式解密出的网址</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111953-4g06vxf.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111953-4g06vxf.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111953-4g06vxf.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410111953-4g06vxf.png?size=large 2x" data-title="image.png" style="--width: 1547px;--aspect-ratio: 1547 / 689;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>ida查看gethostname，执行失败则休眠30秒，然后循环</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112052-g0w4cnb.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112052-g0w4cnb.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112052-g0w4cnb.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112052-g0w4cnb.png?size=large 2x" data-title="image.png" style="--width: 748px;--aspect-ratio: 748 / 519;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>执行成功</p>
<p>htons将主机字节序转换为网络字节序，端口为9999</p>
<p>connect连接主机，参数是网址</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112157-n7g8sui.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112157-n7g8sui.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112157-n7g8sui.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112157-n7g8sui.png?size=large 2x" data-title="image.png" style="--width: 985px;--aspect-ratio: 985 / 546;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>使用这里的字符串对加密的域名解密</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110457-rbp9cdx.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110457-rbp9cdx.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110457-rbp9cdx.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410110457-rbp9cdx.png?size=large 2x" data-title="image.png" style="--width: 420px;--aspect-ratio: 420 / 392;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="8恶意代码在0x0040106e处调用createprocessa函数的意义是什么" class="heading-element"><span>8．恶意代码在0x0040106E处调用createProcessA函数的意义是什么?</span>
  <a href="#8%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81%e5%9c%a80x0040106e%e5%a4%84%e8%b0%83%e7%94%a8createprocessa%e5%87%bd%e6%95%b0%e7%9a%84%e6%84%8f%e4%b9%89%e6%98%af%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>不管connect调用是否成功都会执行sleep</p>
<p>connect成功会调用401000</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112918-geyvfr7.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112918-geyvfr7.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112918-geyvfr7.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410112918-geyvfr7.png?size=large 2x" data-title="image.png" style="--width: 1067px;--aspect-ratio: 1067 / 686;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>401000</p>
<p>showwindow修改为0则不弹出窗口</p>
<p>运行程序的是cmd</p>
<p>后面的标准输入和标准错误都绑定了套接字，则都会发送</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410113001-ee10u9c.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410113001-ee10u9c.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410113001-ee10u9c.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410113001-ee10u9c.png?size=large 2x" data-title="image.png" style="--width: 924px;--aspect-ratio: 924 / 699;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>‍</p>
<h2 id="lab9-3" class="heading-element"><span>Lab9-3</span>
  <a href="#lab9-3" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h2 id="1lab09-03exe导入了哪些dll" class="heading-element"><span>1.Lab09-03.exe导入了哪些DLL?</span>
  <a href="#1lab09-03exe%e5%af%bc%e5%85%a5%e4%ba%86%e5%93%aa%e4%ba%9bdll" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>peid查看</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140507-m40chcf.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140507-m40chcf.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140507-m40chcf.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140507-m40chcf.png?size=large 2x" data-title="image.png" style="--width: 740px;--aspect-ratio: 740 / 422;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140815-jlbkntb.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140815-jlbkntb.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140815-jlbkntb.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140815-jlbkntb.png?size=large 2x" data-title="image.png" style="--width: 1184px;--aspect-ratio: 1184 / 631;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>ida LoadLibrary查看</p>
<p>dll3.dll</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140826-zsuy84y.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140826-zsuy84y.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140826-zsuy84y.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140826-zsuy84y.png?size=large 2x" data-title="image.png" style="--width: 428px;--aspect-ratio: 428 / 90;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>user32.dll</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140849-tac1apf.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140849-tac1apf.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140849-tac1apf.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410140849-tac1apf.png?size=large 2x" data-title="image.png" style="--width: 415px;--aspect-ratio: 415 / 126;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>共导入了6个dll</p>
<h2 id="2dll1dlldll2dlldll3dll要求的基地址是多少" class="heading-element"><span>2.DLL1.dll、DLL2.dll、DLL3.dll要求的基地址是多少?</span>
  <a href="#2dll1dlldll2dlldll3dll%e8%a6%81%e6%b1%82%e7%9a%84%e5%9f%ba%e5%9c%b0%e5%9d%80%e6%98%af%e5%a4%9a%e5%b0%91" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>DLL1.dll</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141041-71wsisj.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141041-71wsisj.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141041-71wsisj.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141041-71wsisj.png?size=large 2x" data-title="image.png" style="--width: 427px;--aspect-ratio: 427 / 389;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>DLL2.dll</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141121-lx1419e.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141121-lx1419e.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141121-lx1419e.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141121-lx1419e.png?size=large 2x" data-title="image.png" style="--width: 416px;--aspect-ratio: 416 / 381;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>DLL3.dll</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141139-ajsbt52.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141139-ajsbt52.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141139-ajsbt52.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141139-ajsbt52.png?size=large 2x" data-title="image.png" style="--width: 426px;--aspect-ratio: 426 / 393;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>3个基地址相同</p>
<h2 id="3当使用ollydbg调试lab09-03exe时为dllldlldll2dlldll3dll分配的基地址是什么" class="heading-element"><span>3.当使用OllyDbg调试Lab09-03.exe时，为DLLl.dll、DLL2.dll、DLL3.dll分配的基地址是什么?</span>
  <a href="#3%e5%bd%93%e4%bd%bf%e7%94%a8ollydbg%e8%b0%83%e8%af%95lab09-03exe%e6%97%b6%e4%b8%badllldlldll2dlldll3dll%e5%88%86%e9%85%8d%e7%9a%84%e5%9f%ba%e5%9c%b0%e5%9d%80%e6%98%af%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>ollydbg打开后按m查看内存视图</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141420-xgntczx.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141420-xgntczx.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141420-xgntczx.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141420-xgntczx.png?size=large 2x" data-title="image.png" style="--width: 549px;--aspect-ratio: 549 / 189;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141510-5ankade.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141510-5ankade.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141510-5ankade.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141510-5ankade.png?size=large 2x" data-title="image.png" style="--width: 1096px;--aspect-ratio: 1096 / 853;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>ida找到loadlibrarya然后od跳转</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141631-44bw0td.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141631-44bw0td.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141631-44bw0td.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141631-44bw0td.png?size=large 2x" data-title="image.png" style="--width: 799px;--aspect-ratio: 799 / 617;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>在下面一行下断点</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141810-zzu813w.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141810-zzu813w.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141810-zzu813w.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410141810-zzu813w.png?size=large 2x" data-title="image.png" style="--width: 1149px;--aspect-ratio: 1149 / 523;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>运行后即导入了DLL3.dll然后看m</p>
<p>可以看到DLLl.dll、DLL2.dll、DLL3.dll分配的基地址</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142104-4ng5w02.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142104-4ng5w02.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142104-4ng5w02.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142104-4ng5w02.png?size=large 2x" data-title="image.png" style="--width: 1196px;--aspect-ratio: 1196 / 626;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="4当lab09-03exe调用dllidll中的一个导入函数时这个导入函数都做了些什么" class="heading-element"><span>4.当Lab09-03.exe调用DLLI.dll中的一个导入函数时，这个导入函数都做了些什么?</span>
  <a href="#4%e5%bd%93lab09-03exe%e8%b0%83%e7%94%a8dllidll%e4%b8%ad%e7%9a%84%e4%b8%80%e4%b8%aa%e5%af%bc%e5%85%a5%e5%87%bd%e6%95%b0%e6%97%b6%e8%bf%99%e4%b8%aa%e5%af%bc%e5%85%a5%e5%87%bd%e6%95%b0%e9%83%bd%e5%81%9a%e4%ba%86%e4%ba%9b%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>print在DLL1.dll里</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142203-7m4uya7.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142203-7m4uya7.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142203-7m4uya7.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142203-7m4uya7.png?size=large 2x" data-title="image.png" style="--width: 476px;--aspect-ratio: 476 / 145;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>DLL1.dll使用ida打开</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142331-wmriwoy.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142331-wmriwoy.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142331-wmriwoy.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142331-wmriwoy.png?size=large 2x" data-title="image.png" style="--width: 1136px;--aspect-ratio: 1136 / 515;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>两个参数</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142833-056w8ht.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142833-056w8ht.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142833-056w8ht.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142833-056w8ht.png?size=large 2x" data-title="image.png" style="--width: 492px;--aspect-ratio: 492 / 619;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>第一个参数是字符串</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142850-yxlcb9g.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142850-yxlcb9g.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142850-yxlcb9g.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142850-yxlcb9g.png?size=large 2x" data-title="image.png" style="--width: 533px;--aspect-ratio: 533 / 336;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>第二个参数在10008030，查看w</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142926-4uielps.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142926-4uielps.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142926-4uielps.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142926-4uielps.png?size=large 2x" data-title="image.png" style="--width: 870px;--aspect-ratio: 870 / 395;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>GetCurrentProcessId获取当前进程id</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142941-h7z0ua5.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142941-h7z0ua5.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142941-h7z0ua5.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142941-h7z0ua5.png?size=large 2x" data-title="image.png" style="--width: 513px;--aspect-ratio: 513 / 194;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="5当lab09-03exe调用writefile函数时它写入的文件名是什么" class="heading-element"><span>5.当Lab09-03.exe调用writeFile函数时，它写入的文件名是什么?</span>
  <a href="#5%e5%bd%93lab09-03exe%e8%b0%83%e7%94%a8writefile%e5%87%bd%e6%95%b0%e6%97%b6%e5%ae%83%e5%86%99%e5%85%a5%e7%9a%84%e6%96%87%e4%bb%b6%e5%90%8d%e6%98%af%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>文件句柄</p>
<p>epb+hfile来源于eax</p>
<p>eax是DLL2ReturnJ</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143335-pohbdwz.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143335-pohbdwz.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143335-pohbdwz.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143335-pohbdwz.png?size=large 2x" data-title="image.png" style="--width: 639px;--aspect-ratio: 639 / 299;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>分析DLL2.dll</p>
<p>DLL2print</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143637-jr0v725.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143637-jr0v725.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143637-jr0v725.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143637-jr0v725.png?size=large 2x" data-title="image.png" style="--width: 634px;--aspect-ratio: 634 / 401;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=large 2x" data-title="image.png" style="--width: 504px;--aspect-ratio: 504 / 264;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>交叉引用</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143800-a6jt6ta.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143800-a6jt6ta.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143800-a6jt6ta.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143800-a6jt6ta.png?size=large 2x" data-title="image.png" style="--width: 803px;--aspect-ratio: 803 / 326;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>返回打开temp.exe文件的句柄</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=large 2x" data-title="image.png" style="--width: 504px;--aspect-ratio: 504 / 264;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144018-7t8w8kl.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144018-7t8w8kl.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144018-7t8w8kl.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144018-7t8w8kl.png?size=large 2x" data-title="image.png" style="--width: 349px;--aspect-ratio: 349 / 128;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>‍</p>
<p>DLL2ReturnJ</p>
<p>返回temp.txt文件句柄</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143650-57fzs7l.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143650-57fzs7l.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143650-57fzs7l.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143650-57fzs7l.png?size=large 2x" data-title="image.png" style="--width: 406px;--aspect-ratio: 406 / 337;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>所以writeFile写入的是temp.txt</p>
<h2 id="6当lab09-03exe使用netschedulejobadd创建一个job时从哪里获取第二个参数的数据" class="heading-element"><span>6.当Lab09-03.exe使用NetScheduleJobAdd创建一个job时，从哪里获取第二个参数的数据?</span>
  <a href="#6%e5%bd%93lab09-03exe%e4%bd%bf%e7%94%a8netschedulejobadd%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aajob%e6%97%b6%e4%bb%8e%e5%93%aa%e9%87%8c%e8%8e%b7%e5%8f%96%e7%ac%ac%e4%ba%8c%e4%b8%aa%e5%8f%82%e6%95%b0%e7%9a%84%e6%95%b0%e6%8d%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>MSDN查看NetScheduleJobAdd</p>
<p>NetScheduleJobAdd函数提交一个作业，在指定的时间和日期运行。此函数要求在提交作业的计算机上启动调度服务</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144642-t5cttk1.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144642-t5cttk1.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144642-t5cttk1.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144642-t5cttk1.png?size=large 2x" data-title="image.png" style="--width: 1002px;--aspect-ratio: 1002 / 655;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>0llydbg查看知道第二个参数是local.7那么在上一个call local.4处被作为参数传递,那么很有可能这个参数的值来自这个函数的操作,跟随进函数查看,果然被赋值为DLL3.003FB0A0</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180520151542243-20220410150001-84s0gbq.png" alt="20180520151542243.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180520151542243-20220410150001-84s0gbq.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180520151542243-20220410150001-84s0gbq.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180520151542243-20220410150001-84s0gbq.png?size=large 2x" data-title="20180520151542243.png" style="--width: 347px;--aspect-ratio: 347 / 67;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180520151624520-20220410150004-bswi3mj.png" alt="20180520151624520.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180520151624520-20220410150004-bswi3mj.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180520151624520-20220410150004-bswi3mj.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/20180520151624520-20220410150004-bswi3mj.png?size=large 2x" data-title="20180520151624520.png" style="--width: 788px;--aspect-ratio: 788 / 246;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>‍</p>
<h3 id="分析dll3dll" class="heading-element"><span>分析DLL3.dll</span>
  <a href="#%e5%88%86%e6%9e%90dll3dll" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><h2 id="7在运行或调试lab09-03exe时你会看到lab09-03exe打印出三块神秘数据dll-1的神秘数据dll2的神秘数据dll-3的神秘数据分别是什么" class="heading-element"><span>7.在运行或调试Lab09-03.exe时,你会看到Lab09-03.exe打印出三块神秘数据。DLL 1的神秘数据，DLL2的神秘数据，DLL 3的神秘数据分别是什么?</span>
  <a href="#7%e5%9c%a8%e8%bf%90%e8%a1%8c%e6%88%96%e8%b0%83%e8%af%95lab09-03exe%e6%97%b6%e4%bd%a0%e4%bc%9a%e7%9c%8b%e5%88%b0lab09-03exe%e6%89%93%e5%8d%b0%e5%87%ba%e4%b8%89%e5%9d%97%e7%a5%9e%e7%a7%98%e6%95%b0%e6%8d%aedll-1%e7%9a%84%e7%a5%9e%e7%a7%98%e6%95%b0%e6%8d%aedll2%e7%9a%84%e7%a5%9e%e7%a7%98%e6%95%b0%e6%8d%aedll-3%e7%9a%84%e7%a5%9e%e7%a7%98%e6%95%b0%e6%8d%ae%e5%88%86%e5%88%ab%e6%98%af%e4%bb%80%e4%b9%88" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="dll1神秘数据" class="heading-element"><span>DLL1神秘数据</span>
  <a href="#dll1%e7%a5%9e%e7%a7%98%e6%95%b0%e6%8d%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>第一个参数是字符串</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142850-yxlcb9g.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142850-yxlcb9g.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142850-yxlcb9g.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142850-yxlcb9g.png?size=large 2x" data-title="image.png" style="--width: 533px;--aspect-ratio: 533 / 336;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>第二个参数在10008030，查看w</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142926-4uielps.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142926-4uielps.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142926-4uielps.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142926-4uielps.png?size=large 2x" data-title="image.png" style="--width: 870px;--aspect-ratio: 870 / 395;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>GetCurrentProcessId获取当前进程id</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142941-h7z0ua5.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142941-h7z0ua5.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142941-h7z0ua5.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410142941-h7z0ua5.png?size=large 2x" data-title="image.png" style="--width: 513px;--aspect-ratio: 513 / 194;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>当前进程id值</p>
<h3 id="dll2神秘数据" class="heading-element"><span>DLL2神秘数据</span>
  <a href="#dll2%e7%a5%9e%e7%a7%98%e6%95%b0%e6%8d%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>分析DLL2.dll</p>
<p>DLL2print</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143637-jr0v725.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143637-jr0v725.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143637-jr0v725.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143637-jr0v725.png?size=large 2x" data-title="image.png" style="--width: 634px;--aspect-ratio: 634 / 401;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=large 2x" data-title="image.png" style="--width: 504px;--aspect-ratio: 504 / 264;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>交叉引用</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143800-a6jt6ta.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143800-a6jt6ta.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143800-a6jt6ta.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143800-a6jt6ta.png?size=large 2x" data-title="image.png" style="--width: 803px;--aspect-ratio: 803 / 326;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>返回打开temp.exe文件的句柄</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410143807-ghoir2e.png?size=large 2x" data-title="image.png" style="--width: 504px;--aspect-ratio: 504 / 264;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144018-7t8w8kl.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144018-7t8w8kl.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144018-7t8w8kl.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144018-7t8w8kl.png?size=large 2x" data-title="image.png" style="--width: 349px;--aspect-ratio: 349 / 128;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="dll3神秘数据" class="heading-element"><span>DLL3神秘数据</span>
  <a href="#dll3%e7%a5%9e%e7%a7%98%e6%95%b0%e6%8d%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>DLL3print</p>
<p>打印的是WideCharStr的数据</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144922-2zhwco4.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144922-2zhwco4.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144922-2zhwco4.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410144922-2zhwco4.png?size=large 2x" data-title="image.png" style="--width: 537px;--aspect-ratio: 537 / 315;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>交叉引用WideCharStr</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145025-cf9f0pv.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145025-cf9f0pv.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145025-cf9f0pv.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145025-cf9f0pv.png?size=large 2x" data-title="image.png" style="--width: 761px;--aspect-ratio: 761 / 303;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>MultiByteToWideChar函数</p>
<p>多字节转宽字节形式，要转换的是第3个参数</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145211-y29ahp1.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145211-y29ahp1.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145211-y29ahp1.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145211-y29ahp1.png?size=large 2x" data-title="image.png" style="--width: 960px;--aspect-ratio: 960 / 408;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145133-5za95q0.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145133-5za95q0.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145133-5za95q0.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145133-5za95q0.png?size=large 2x" data-title="image.png" style="--width: 1017px;--aspect-ratio: 1017 / 717;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>要转换的是lpMultiByteStr即ping <a href="https://www.malwareanalysisbook.com"target="_blank" rel="external nofollow noopener noreferrer">www.malwareanalysisbook.com</a></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145059-2w6eyoo.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145059-2w6eyoo.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145059-2w6eyoo.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410145059-2w6eyoo.png?size=large 2x" data-title="image.png" style="--width: 930px;--aspect-ratio: 930 / 515;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>DLL3.dll打印的神秘数据是ping <a href="https://www.malwareanalysisbook.com"target="_blank" rel="external nofollow noopener noreferrer">www.malwareanalysisbook.com</a>在内存中的地址</p>
<h2 id="8如何将dll2dll加载到ida-pro中使得它与ollydbg-使用的加载地址匹配" class="heading-element"><span>8.如何将DLL2.dll加载到IDA Pro中，使得它与OllyDbg 使用的加载地址匹配?</span>
  <a href="#8%e5%a6%82%e4%bd%95%e5%b0%86dll2dll%e5%8a%a0%e8%bd%bd%e5%88%b0ida-pro%e4%b8%ad%e4%bd%bf%e5%be%97%e5%ae%83%e4%b8%8eollydbg-%e4%bd%bf%e7%94%a8%e7%9a%84%e5%8a%a0%e8%bd%bd%e5%9c%b0%e5%9d%80%e5%8c%b9%e9%85%8d" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>选择手动加载</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150204-szfsixc.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150204-szfsixc.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150204-szfsixc.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150204-szfsixc.png?size=large 2x" data-title="image.png" style="--width: 615px;--aspect-ratio: 615 / 567;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>查看od的dll2.dll基地址</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150249-k196l6a.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150249-k196l6a.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150249-k196l6a.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150249-k196l6a.png?size=large 2x" data-title="image.png" style="--width: 519px;--aspect-ratio: 519 / 85;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>输入od里的dll2.dll基地址，一直ok</p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150321-245z79f.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150321-245z79f.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150321-245z79f.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150321-245z79f.png?size=large 2x" data-title="image.png" style="--width: 701px;--aspect-ratio: 701 / 275;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150418-9qb7v9v.png" alt="image.png" srcset="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150418-9qb7v9v.png?size=small, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150418-9qb7v9v.png?size=medium 1.5x, /posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/images/image-20220410150418-9qb7v9v.png?size=large 2x" data-title="image.png" style="--width: 1287px;--aspect-ratio: 1287 / 673;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>‍</p>
<p>‍</p></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2022-03-29 21:47:44">Updated on 2022-03-29&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Share on X" data-sharer="twitter" data-url="http://localhost:1313/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/" data-title="恶意代码分析实战Lab9" data-hashtags="病毒分析,Binary"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/" data-hashtag="病毒分析"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://localhost:1313/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab9/" data-title="恶意代码分析实战Lab9"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90/" class="post-tag" title="Tags - 病毒分析">病毒分析</a><a href="/tags/binary/" class="post-tag" title="Tags - Binary">Binary</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab1/" class="post-nav-item" rel="prev" title="恶意代码分析实战Lab1"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>恶意代码分析实战Lab1</a><a href="/posts/%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98%E5%88%86%E6%9E%90lab7/" class="post-nav-item" rel="next" title="恶意代码分析实战Lab7">恶意代码分析实战Lab7<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.141.0">Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.16">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/">xiaole</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":1000},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"version":"v0.3.16"};console.log('Page config:', window.config);</script><script src="/js/theme.min.js" defer></script></body>
</html>
